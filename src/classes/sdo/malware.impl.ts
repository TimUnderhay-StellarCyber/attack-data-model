import type { Malware } from '../../schemas/sdo/malware.schema.js';
import { AttackBaseImpl } from '../common/attack-object.impl.js';
import { TechniqueImpl } from './technique.impl.js';

export class MalwareImpl extends AttackBaseImpl implements Malware {

    private _techniques: TechniqueImpl[] = [];

    constructor(readonly malware: Malware) {
        super();
        Object.assign(this, malware);
    }

    // Add a technique used by the malware
    addTechnique(technique: TechniqueImpl): void {
        this._techniques.push(technique);
    }

    // Getters
    getTechniques(): TechniqueImpl[] {
        return this._techniques;
    }
}

export interface MalwareImpl extends Malware { }