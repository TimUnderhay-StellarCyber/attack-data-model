{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Schema for ATT&CK Groups - Relationship",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "id",
    "type",
    "spec_version",
    "objects"
  ],
  "properties": {
    "id": {
      "type": "string",
      "pattern": "^[a-zA-Z0-9-]+$",
      "description": "(STIX v2.0 required common property) A unique identifier for the relationship"
    },
    "type": {
      "type": "string",
      "enum": [
        "bundle"
      ],
      "description": "(STIX v2.0 required) The type of object, 'relationship' is type 'bundle'"
    },
    "spec_version": {
      "type": "string",
      "enum": [
        "2.0"
      ],
      "description": "The version of the STIX specification used to represent the content in this Bundle."
    },
    "objects": {
      "type": "array",
      "items": [
        {
          "type": "object",
          "additionalProperties": false,
          "required": [
            "id",
            "type",
            "relationship_type",
            "source_ref",
            "target_ref"
          ],
          "properties": {
            "id": {
              "type": "string",
              "pattern": "^[a-zA-Z0-9-]+$",
              "description": "A unique identifier for the relationship."
            },
            "type": {
              "type": "string",
              "enum": [
                "relationship"
              ],
              "description": "Type of this object"
            },
            "created": {
              "type": "string",
              "description": "(STIX v2.0 optional common property) The date and time the relationship was first created."
            },
            "created_by_ref": {
              "type": "string",
              "description": "(STIX v2.0 optional common property) specifies the ID of the Identity object that describes the entity that created this object."
            },
            "external_references": {
              "type": "array",
              "description": "A list of external references (e.g., URLs or other reference material) that provide more information about the software.",
              "items": [
                {
                  "type": "object",
                  "properties": {
                    "source_name": {
                      "type": "string",
                      "description": "The name of the external source."
                    },
                    "external_id": {
                      "type": "string"
                    },
                    "url": {
                      "type": "string",
                      "format": "uri",
                      "description": "The URL of the external source."
                    },
                    "description": {
                      "type": "string"
                    }
                  },
                  "required": [
                    "source_name"
                  ]
                }
              ]
            },
            "modified": {
              "type": "string",
              "description": "(STIX v2.0 optional common property) The date and time this version of the relationship was last modified."
            },
            "description": {
              "type": "string",
              "description": "A description that provides more details and context about the Course of Action, potentially including its purpose and its key characteristics."
            },
            "object_marking_refs": {
              "type": "array",
              "description": "(STIX v2.0 optional)",
              "items": [
                {
                  "type": "string"
                }
              ]
            },
            "relationship_type": {
              "type": "string",
              "description": "The name used to identify the type of Relationship"
            },
            "source_ref": {
              "type": "string",
              "description": "The id of the source (from) object"
            },
            "target_ref": {
              "type": "string",
              "description": "The id of the target (to) object."
            },
            "x_mitre_version": {
              "type": "string",
              "description": "The version of the object in format major.minor"
            },
            "x_mitre_modified_by_ref": {
              "type": "string",
              "description": "The identity of the individual or organization which created the current version of the object."
            },
            "revoked": {
              "type": "boolean",
              "description": "(STIX v2.0 optional common property) Whether the object has been revoked."
            },"x_mitre_deprecated": {
              "type": "boolean",
              "description": "Optional: Whether the object has been deprecated"
            },
            "x_mitre_attack_spec_version": {
              "type": "string",
              "description": "Optional: This field tracks the version of the ATT&CK Spec used by the object."
            }
          }
        }
      ]

    }
  }
}
